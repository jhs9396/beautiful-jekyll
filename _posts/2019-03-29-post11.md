---
layout: post
title: Example of Graph data community detection by AgensGraph PL/Python. 1 to 2
image: /img/hello_world.jpeg
---

## Environment
- AgensGraph v2.0 release
- CentOS 7 (python 2.7)
- enabled 'pip' executor

## Setting
#### step 1. AgensGraph install (configure --with-python)
- If you downloaded AgensGraph 2.0 source, you must be compiled C language files. Because we will use PL/Python in AgensGraph.
- When you compiled files, you need to configure setting 

````
user@pwd/blah/blah$ ./configure --prefix=$HOME/agraph --with-python
...
user@pwd/blah/blah$ make && make install-world
````
- Next phase are init db, ag_ctl start, create db and etc.. Reference guide : <https://github.com/bitnine-oss/agensgraph>
- I will use the following:
````
agens (AgensGraph 2.0.0, based on PostgreSQL 10.4)
Type "help" for help.

agens=#
agens=# CREATE GRAPH community_detection;
CREATE GRAPH
agens=# SET GRAPH_PATH TO community_detection;
SET
agens=#
````
#### step 2. AgensGraph plpython language creating
- If you follow along well, the next step is easy.
- In CLI, the following:

````
CREATE LANGUAGE plpythonu;
````

#### step 3. python networkx library download
- By using 'pip' executor, you can use the download networkx library.
- And pip install networkx, pip install python-louvain, pip install numpy
- (account with administrator rights)
````
user@pwd/blah/blah$ sudo pip install networkx
user@pwd/blah/blah$ sudo pip install python-louvain
user@pwd/blah/blah$ sudo pip install numpy
````

#### step 4. community detection example
- Next. In AgensGraph CLI mode, you can write the script used python.
- It is similar to Oracle's PL/SQL. AgensGraph uses python as the procedure language. Of course, SQL also exists.
- Dataset is 6 nodes and 3 edges. following:
````
SET GRAPH_PATH TO community_detection;

CREATE (a:person {name:'hsjeon'})-[r:knows]->(b:person {name:'jhs'});
CREATE (a:person {name:'foo'})-[r:knows]->(b:person {name:'bar'});
CREATE (a:person {name:'test'})-[r:knows]->(b:person {name:'test1'});
````

````
````
